<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover" />
  <meta name="theme-color" content="#6c5ce7" />
  <title>B√ºt√ße Takip</title>

  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>

  <link rel="stylesheet" href="style.css?v=20260212-2" />

  <style>
    #bootLog{
      position:fixed;left:12px;right:12px;bottom:12px;
      background:#111;color:#0f0;font:12px/1.35 ui-monospace,Menlo,monospace;
      padding:10px;border-radius:12px;opacity:.95;z-index:9999;
      max-height:40vh;overflow:auto;
    }
  </style>
</head>

<body>
  <div id="bootLog">Boot: ba≈ülƒ±yor...</div>

  <header class="header">
    <div class="brand">
      <div class="brand-icon">üí∞</div>
      <div class="brand-text">
        <div class="brand-title">B√ºt√ße</div>
        <div class="brand-sub" id="headerSubtitle">Plan / Ger√ßekle≈üen</div>
      </div>
    </div>
    <div class="auth">
      <span id="userLabel" class="auth-label">Giri≈ü yapƒ±lmadƒ±</span>
      <button id="btnLogin" class="auth-btn" type="button">Giri≈ü</button>
      <button id="btnLogout" class="auth-btn ghost" type="button" style="display:none;">√áƒ±kƒ±≈ü</button>
    </div>
  </header>

  <main class="container">
    <section class="summary">
      <div class="summary-card income">
        <div class="summary-title">Gelir</div>
        <div class="summary-value" id="sumIncome">$0</div>
        <div class="summary-sub" id="sumIncomeSub">Plan / Ger√ßek</div>
      </div>
      <div class="summary-card expense">
        <div class="summary-title">Gider</div>
        <div class="summary-value" id="sumExpense">$0</div>
        <div class="summary-sub" id="sumExpenseSub">Plan / Ger√ßek</div>
      </div>
      <div class="summary-card net">
        <div class="summary-title">Net</div>
        <div class="summary-value" id="sumNet">$0</div>
        <div class="summary-sub" id="sumNetSub">Plan / Ger√ßek</div>
      </div>
    </section>

    <div class="tabs">
      <div class="tab active" data-tab="budget">B√ºt√ße</div>
      <div class="tab" data-tab="transactions">ƒ∞≈ülemler</div>
      <div class="tab" data-tab="balance">Bilan√ßo</div>
    </div>

    <section class="section active" id="budget-section">
      <div class="section-title">
        <span>Kur Tahminleri (Plan)</span>
        <button class="add-btn" id="btnRatesEdit" type="button">
          <i class="fas fa-pen"></i> D√ºzenle
        </button>
      </div>
      <div class="rates-card" id="ratesCard"></div>

      <div class="section-title" style="margin-top:18px;">
        <span>Gelir Kalemleri</span>
        <button class="add-btn" type="button" onclick="openCategoryModal('income')">
          <i class="fas fa-plus"></i> Ekle
        </button>
      </div>
      <div id="incomeBudgets"></div>

      <div class="section-title" style="margin-top:18px;">
        <span>Gider Kalemleri</span>
        <button class="add-btn" type="button" onclick="openCategoryModal('expense')">
          <i class="fas fa-plus"></i> Ekle
        </button>
      </div>
      <div id="expenseBudgets"></div>
    </section>

    <section class="section" id="transactions-section">
      <div class="month-filter" id="monthFilter"></div>
      <div id="transactionsList"></div>
    </section>

    <section class="section" id="balance-section">
      <div class="month-filter" id="balMonthFilter"></div>
      <div class="balance-top">
        <div class="balance-kpi"><div class="kpi-title">Varlƒ±klar</div><div class="kpi-value" id="balAssets">$0</div></div>
        <div class="balance-kpi"><div class="kpi-title">Bor√ßlar</div><div class="kpi-value" id="balLiab">$0</div></div>
        <div class="balance-kpi"><div class="kpi-title">√ñz Sermaye</div><div class="kpi-value" id="balEquity">$0</div></div>
      </div>

      <div class="chart-card">
        <div class="chart-title">Aylƒ±k Trend (USD)</div>
        <canvas id="balanceChart"></canvas>
      </div>

      <div class="note muted">Bilan√ßo test</div>
    </section>
  </main>

  <button class="fab" type="button" onclick="openTransactionModal()">
    <i class="fas fa-plus"></i>
  </button>

  <!-- ‚úÖ BOOT LOG -->
  <script>
    const boot = document.getElementById("bootLog");
    const log = (s)=>{ boot.textContent += "\n" + s; boot.scrollTop = boot.scrollHeight; console.log(s); };
    log("Boot: HTML y√ºklendi");

    window.addEventListener("error", (e)=>{
      log("‚ùå JS error: " + e.message);
      alert("JS HATASI: " + e.message);
    });

    window.addEventListener("unhandledrejection", (e)=>{
      log("‚ùå Promise error: " + (e.reason?.message||e.reason));
      alert("PROMISE HATASI: " + (e.reason?.message||e.reason));
    });
  </script>

  <!-- ‚úÖ √ñnce firebase module -->
  <script type="module">
    const boot = document.getElementById("bootLog");
    const log = (s)=>{ boot.textContent += "\n" + s; boot.scrollTop = boot.scrollHeight; console.log(s); };

    log("firebase.js y√ºkleniyor...");
    import("./firebase.js?v=20260212-2")
      .then(()=>log("‚úÖ firebase.js OK"))
      .catch((e)=>{ log("‚ùå firebase.js FAIL: " + e.message); alert("firebase.js hata: " + e.message); });
  </script>

  <!-- ‚úÖ Sonra app.js -->
  <script defer src="app.js?v=20260212-2" onload="document.getElementById('bootLog').textContent += '\n‚úÖ app.js OK'" onerror="alert('app.js y√ºklenemedi')"></script>
</body>
</html>
