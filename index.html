<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="BÃ¼tÃ§e" />
  <meta name="theme-color" content="#6c5ce7" />

  <title>BÃ¼tÃ§e Takip</title>

  <!-- iOS icon -->
  <link rel="apple-touch-icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect fill='%236c5ce7' width='100' height='100' rx='20'/><text x='50' y='62' text-anchor='middle' font-size='45' fill='white'>%F0%9F%92%B0</text></svg>">

  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>

  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <!-- HEADER -->
  <header class="header">
    <div class="brand">
      <div class="brand-icon">ğŸ’°</div>
      <div class="brand-text">
        <div class="brand-title">BÃ¼tÃ§e</div>
        <div class="brand-sub" id="headerSubtitle">Plan / GerÃ§ekleÅŸen</div>
      </div>
    </div>

    <!-- Mini login (UI bozmasÄ±n) -->
    <div class="auth">
      <span id="userLabel" class="auth-label">GiriÅŸ yapÄ±lmadÄ±</span>
      <button id="btnLogin" class="auth-btn">GiriÅŸ</button>
      <button id="btnLogout" class="auth-btn ghost" style="display:none;">Ã‡Ä±kÄ±ÅŸ</button>
    </div>
  </header>

  <main class="container">
    <!-- TOP SUMMARY -->
    <section class="summary">
      <div class="summary-card income">
        <div class="summary-title">Gelir</div>
        <div class="summary-value" id="sumIncome">$0</div>
        <div class="summary-sub" id="sumIncomeSub">Plan / GerÃ§ek</div>
      </div>

      <div class="summary-card expense">
        <div class="summary-title">Gider</div>
        <div class="summary-value" id="sumExpense">$0</div>
        <div class="summary-sub" id="sumExpenseSub">Plan / GerÃ§ek</div>
      </div>

      <div class="summary-card net">
        <div class="summary-title">Net</div>
        <div class="summary-value" id="sumNet">$0</div>
        <div class="summary-sub" id="sumNetSub">Plan / GerÃ§ek</div>
      </div>
    </section>

    <!-- TABS -->
    <div class="tabs">
      <div class="tab active" data-tab="budget">BÃ¼tÃ§e</div>
      <div class="tab" data-tab="transactions">Ä°ÅŸlemler</div>
      <div class="tab" data-tab="balance">BilanÃ§o</div>
    </div>

    <!-- BUDGET -->
    <section class="section active" id="budget-section">
      <div class="section-title">
        <span>Kur Tahminleri (Plan)</span>
        <button class="add-btn" id="btnRatesEdit">
          <i class="fas fa-pen"></i> DÃ¼zenle
        </button>
      </div>
      <div class="rates-card" id="ratesCard"></div>

      <div class="section-title" style="margin-top: 18px;">
        <span>Gelir Kalemleri</span>
        <button class="add-btn" onclick="openCategoryModal('income')">
          <i class="fas fa-plus"></i> Ekle
        </button>
      </div>
      <div id="incomeBudgets"></div>

      <div class="section-title" style="margin-top: 18px;">
        <span>Gider Kalemleri</span>
        <button class="add-btn" onclick="openCategoryModal('expense')">
          <i class="fas fa-plus"></i> Ekle
        </button>
      </div>
      <div id="expenseBudgets"></div>
    </section>

    <!-- TRANSACTIONS -->
    <section class="section" id="transactions-section">
      <div class="month-filter" id="monthFilter"></div>
      <div id="transactionsList"></div>
    </section>

    <!-- BALANCE -->
    <section class="section" id="balance-section">
      <div class="month-filter" id="balMonthFilter"></div>

      <div class="balance-top">
        <div class="balance-kpi">
          <div class="kpi-title">VarlÄ±klar</div>
          <div class="kpi-value" id="balAssets">$0</div>
        </div>
        <div class="balance-kpi">
          <div class="kpi-title">BorÃ§lar</div>
          <div class="kpi-value" id="balLiab">$0</div>
        </div>
        <div class="balance-kpi">
          <div class="kpi-title">Ã–z Sermaye</div>
          <div class="kpi-value" id="balEquity">$0</div>
        </div>
      </div>

      <div class="chart-card">
        <div class="chart-title">AylÄ±k Trend (USD)</div>
        <canvas id="balanceChart"></canvas>
      </div>

      <div class="balance-grid">
        <div class="balance-col">
          <div class="section-title">
            <span>VarlÄ±klar</span>
          </div>

          <div class="group">
            <div class="group-head">
              <span>Nakit</span>
              <button class="mini-btn" onclick="openBalItemModal('asset','cash')"><i class="fas fa-plus"></i></button>
            </div>
            <div class="group-body" id="asset-cash"></div>
          </div>

          <div class="group">
            <div class="group-head">
              <span>YatÄ±rÄ±mlar</span>
              <button class="mini-btn" onclick="openBalItemModal('asset','invest')"><i class="fas fa-plus"></i></button>
            </div>
            <div class="group-body" id="asset-invest"></div>
          </div>

          <div class="group">
            <div class="group-head">
              <span>Alacaklar</span>
              <button class="mini-btn" onclick="openBalItemModal('asset','recv')"><i class="fas fa-plus"></i></button>
            </div>
            <div class="group-body" id="asset-recv"></div>
          </div>
        </div>

        <div class="balance-col">
          <div class="section-title">
            <span>BorÃ§lar</span>
          </div>

          <div class="group">
            <div class="group-head">
              <span>Krediler</span>
              <button class="mini-btn" onclick="openBalItemModal('liab','loan')"><i class="fas fa-plus"></i></button>
            </div>
            <div class="group-body" id="liab-loan"></div>
          </div>

          <div class="group">
            <div class="group-head">
              <span>Kredi KartÄ±</span>
              <button class="mini-btn" onclick="openBalItemModal('liab','card')"><i class="fas fa-plus"></i></button>
            </div>
            <div class="group-body" id="liab-card"></div>
          </div>

          <div class="group">
            <div class="group-head">
              <span>DiÄŸer BorÃ§lar</span>
              <button class="mini-btn" onclick="openBalItemModal('liab','other')"><i class="fas fa-plus"></i></button>
            </div>
            <div class="group-body" id="liab-other"></div>
          </div>
        </div>
      </div>

      <div class="note muted">
        Kural: Ä°ÅŸlem kategorisi adÄ± bilanÃ§o alt kalem adÄ±yla eÅŸleÅŸirse otomasyon Ã§alÄ±ÅŸÄ±r.
        <br/>â€¢ AynÄ± isimli borÃ§ varsa â†’ borÃ§ dÃ¼ÅŸer
        <br/>â€¢ AynÄ± isimli varlÄ±k da varsa â†’ varlÄ±k artar
        <br/>â€¢ VarlÄ±k yoksa â†’ varlÄ±k tarafÄ±na dokunma
      </div>
    </section>
  </main>

  <!-- FAB -->
  <button class="fab" onclick="openTransactionModal()">
    <i class="fas fa-plus"></i>
  </button>

  <!-- Install Banner -->
  <div class="install-banner" id="installBanner">
    <h3>ğŸ“± iPhone'a YÃ¼kle</h3>
    <p>Bu uygulamayÄ± ana ekranÄ±nÄ±za ekleyebilirsiniz:</p>
    <div class="steps">
      1ï¸âƒ£ Safari'de <strong>PaylaÅŸ</strong> butonuna tÄ±klayÄ±n <i class="fas fa-share-square"></i><br>
      2ï¸âƒ£ <strong>"Ana Ekrana Ekle"</strong> seÃ§in<br>
      3ï¸âƒ£ <strong>"Ekle"</strong> butonuna tÄ±klayÄ±n
    </div>
    <button class="install-close" onclick="hideInstallBanner()">AnladÄ±m</button>
  </div>

  <!-- Category Modal -->
  <div class="modal-overlay" id="categoryModal">
    <div class="modal">
      <div class="modal-header">
        <h2 id="catModalTitle">Kategori</h2>
        <button class="modal-close" onclick="closeModal('categoryModal')">Ã—</button>
      </div>

      <div class="modal-body">
        <label>Kategori AdÄ±</label>
        <input id="catName" type="text" placeholder="Ã–rn: MaaÅŸ, Kira, Akbank..." />

        <div class="row2">
          <div>
            <label>Para Birimi (Plan)</label>
            <select id="catCurrency">
              <option value="USD">USD</option>
              <option value="TRY">TRY</option>
              <option value="RUB">RUB</option>
            </select>
          </div>

          <div>
            <label>YÄ±llÄ±k Plan</label>
            <input id="catYearly" type="number" step="0.01" placeholder="0" />
          </div>
        </div>

        <div class="modal-actions">
          <button class="btn primary" id="btnSaveCategory">Kaydet</button>
        </div>

        <div class="muted small">Not: YÄ±llÄ±k plan, seÃ§ili ay iÃ§in 12â€™ye bÃ¶lÃ¼nÃ¼p ay bazÄ±na yazÄ±lÄ±r. Ä°stersen sonra ay bazÄ±nda dÃ¼zenlersin.</div>
      </div>
    </div>
  </div>

  <!-- Transaction Modal -->
  <div class="modal-overlay" id="transactionModal">
    <div class="modal">
      <div class="modal-header">
        <h2>Yeni Ä°ÅŸlem</h2>
        <button class="modal-close" onclick="closeModal('transactionModal')">Ã—</button>
      </div>

      <div class="type-toggle">
        <button class="type-btn income active" onclick="setTransactionType('income')">
          <i class="fas fa-arrow-down"></i> Gelir
        </button>
        <button class="type-btn expense" onclick="setTransactionType('expense')">
          <i class="fas fa-arrow-up"></i> Gider
        </button>
      </div>

      <div class="modal-body">
        <div class="row2">
          <div>
            <label>Tarih</label>
            <input id="txDate" type="date" />
          </div>
          <div>
            <label>Para Birimi</label>
            <select id="txCurrency">
              <option value="USD">USD</option>
              <option value="TRY">TRY</option>
              <option value="RUB">RUB</option>
            </select>
          </div>
        </div>

        <label>Tutar</label>
        <input id="txAmount" type="number" step="0.01" placeholder="0" />

        <label>Kategori</label>
        <select id="txCategory"></select>

        <label>Not</label>
        <input id="txNote" type="text" placeholder="AÃ§Ä±klama..." />

        <div class="modal-actions">
          <button class="btn primary" id="btnAddTx">Kaydet</button>
        </div>

        <div class="muted small" id="txInfo"></div>
      </div>
    </div>
  </div>

  <!-- Balance Item Modal -->
  <div class="modal-overlay" id="balItemModal">
    <div class="modal">
      <div class="modal-header">
        <h2 id="balItemTitle">Kalem Ekle</h2>
        <button class="modal-close" onclick="closeModal('balItemModal')">Ã—</button>
      </div>

      <div class="modal-body">
        <label>Kategori AdÄ±</label>
        <input id="balItemName" type="text" placeholder="Ã–rn: Akbank, Ahmet, BTC..." />

        <div class="row2">
          <div>
            <label>Para Birimi</label>
            <select id="balItemCurrency">
              <option value="USD">USD</option>
              <option value="TRY">TRY</option>
              <option value="RUB">RUB</option>
            </select>
          </div>
          <div>
            <label>Tutar</label>
            <input id="balItemAmount" type="number" step="0.01" placeholder="0" />
          </div>
        </div>

        <label>Not</label>
        <input id="balItemNote" type="text" placeholder="AÃ§Ä±klama..." />

        <div class="modal-actions">
          <button class="btn primary" id="btnSaveBalItem">Kaydet</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script type="module" src="firebase.js"></script>
  <script src="app.js"></script>
</body>
</html>
